#!/bin/sh

set -e

package="$1"
shift

# development
invocation="cargo run --package $package --"

if ! test -z "$FAST"; then
  invocation="target/release/$package"
  if ! test -f "$invocation"; then
    echo "[$(date)] Building missing fast build of $package"
    time cargo build --quiet --release --package $package
  fi
fi

$invocation "$@"
